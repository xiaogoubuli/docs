<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Assembly Language</title>
</head>
<body>
<pre>
“深入理解机器工作的基本原理”和“培养底层编程意识和思想”

汇编语言的主体是汇编指令。汇编指令和机器指令的差别在于指令的表示方法上。汇编指令是机器指令便于记忆的书写格式。

每一种CPU都有自己的汇编指令集。

汇编语言的组成：
1. 汇编指令：机器码的助记符，有对应的机器码。
2. 伪指令：没有对应的机器码，由编译器执行，计算机并不执行。
3. 其他符号：如+、-、/等，由编译器识别，没有对应的机器码。

汇编语言的核心是汇编指令，它决定了汇编语言的特性。

总线：地址总线、控制总线、数据总线。

一个CPU有N根地址线，则可以说这个CPU的地址总线的宽度为N。这样的CPU最多可以寻找2的N次方个内存单元。

数据总线的宽度决定了CPU和外界的数据传送速度。

控制总线是一些不同控制线的集合。有多少根控制线，就意味着CPU提供了对外部器件的多少种控制。所以，控制总线的宽度决定了CPU对外部器件的控制能力。

一个典型的CPU由运算器、控制器、寄存器等器件构成，这些器件靠内部总线相连。

在CPU中：
1. 运算器进行信息处理；
2. 寄存器进行信息存储；
3. 控制器控制各种器件进行工作；
4. 内部总线连接各种器件，在它们之间进行数据的传送。

8086CPU的寄存器：AX、BX、CX、DX、SI、DI、SP、BP、IP、CS、SS、DS、ES、PSW。

8086CPU的所有寄存器都是16位的，可以存放两个字节。

AX、BX、CX、DX这4个寄存器通常用来存放一般性的数据，被称为通用寄存器。

8086CPU的AX、BX、CX、DX都可分为两个可独立使用的8位寄存器来用：
AX可分为AH和AL；
BX可分为BH和BL；
CX可分为CH和CL；
DX可分为DH和DL。

在进行数据传送或运算时，要注意指令的两个操作对象的位数应当是一致的。

地址加法器：物理地址=段地址*16+偏移地址

“段地址*16+偏移地址=物理地址”的本质含义是：CPU在访问内存时，用一个基础地址（段地址*16）和一个相对于基础地址的偏移地址相加，给出内存单元的物理地址。

Windows7 debug模式：

debug
R - 查看、改变CPU寄存器的内容
D - 查看内存中的内容
E - 改写内存中的内容
U - 将内存中的机器指令翻译成汇编指令
T - 执行一条机器指令
A - 以汇编指令的格式在内存中写入一条机器指令
P - 
debug默认所有数据都用十六进制表示。


-d [段地址:起始偏移地址 [结尾偏移地址]]
示例：
-d
-d 1000:0
-d 1000:0 9

-e 起始地址 [数据...]
示例：
-e 1000:0
-e 1000:0 0 1 2 3 4 5 6 7 8 9
-e 1000:0 1 'a' 2 'b' 3 'c'
-e 1000:0 1 "a+b" 2 "c++" 3 "IBM"

8086CPU不支持将数据直接送入段寄存器的操作。

8080CPU的入栈和出栈操作都是以字为单位进行的。
入栈时，栈顶从高地址向低地址方向增长。


段名 segment
...
段名 ends

一个有意义的汇编程序中至少要有一个段，这个段用来存放代码。

end 汇编程序的结束标记。

在汇编源程序中，数据不能以字母开头，所以要在前面加0。


assume cs:code,ds:data,ss:stack

data segment
    dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h
data ends

stack segment
    dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
stack ends

code segment
start:  mov ax,stack
        mov ss,ax
        mov sp,20h
        mov ax,data
        mov ds,ax

        mov ax,4c00h
        int 21h
code ends

end start






汇编指令：

add

call
    1. 将当前的IP或CS和IP压入栈中
    2. 转移

dec

div 除法指令
    1. 除数：有8位和16位两种，在一个reg或内存单元中。
    2. 被除数：默认放在AX或DX和AX中，如果除数为8位，被除数则为16位，默认在AX中存放；如果被除数为32位，在DX和AX中存放，DX存放高16位，AX存放低16位。
    3. 结果：如果除数为8位，则AL存储除法操作的商，AH存储除法操作的余数；如果除数为16位，则AX存储除法操作的商，DX存储除法操作的余数。

inc

int

jcxz 有条件转移指令，所有的有条件转移指令都是短转移
指令格式：jcxz 标号

jmp

loop 循环指令，所有的循环指令都是短转移
指令格式：loop 标号

mov

mul

pop

push

ret 用栈中的数据修改IP的内容，从而实现近转移
    1. (IP)=((ss)*16+(sp))
    2. (sp)=(sp)+2

retf 用栈中的数据修改CS和IP的内容，从而实现远转移
    1. (IP)=((ss)*16+(sp))
    2. (sp)=(sp)+2
    3. (CS)=((ss)*16+(sp))
    4. (sp)=(sp)+2

伪指令：
db 定义字节型数据
dw 定义字型数据
dd 定义双字型数据

操作符
dup 重复定义数据
    示例：
    db 重复的次数 dup (重复的字节型数据)
    dw 重复的次数 dup (重复的字型数据)
    dd 重复的次数 dup (重复的双字节型数据)

offset 取得标号的偏移地址












</pre>
</body>
</html>
